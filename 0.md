Вводная работа. Знакомство с seL4 SOS
=====================================

В данной работе Вам предстоит познакомиться с ядром seL4 на достаточно простом примере, содержащим очень четкие и детализированные инструкции вкупе с исходным кодом и руководством по эксплуатации ядра sel4, с которым у Вас не должно возникнуть проблем при решении данного примера.

    Milestone 0: Familiarisation
    Your Environment
    Building SOS
    Getting SOS on non-lab machines
    Getting it Going
    Development cycle
    The Milestone
    Recommended procedure
    Assessment
    Milestone submission
    Milestone Demonstration

Ваше окружение
--------------

Если Вы еще не подготовили Ваше окружение разработчика, Ваш компьютер и Ваш Sabre Lite для работы, то пора это сделать. Как именно это сделать, Вы сможете найти в Sabre Lite Lab.

Большая часть из двоичных файлов проекта 9242 (в т.ч. кросс-компиляторы) расположены в ~cs9242/crossdev/arm-2013.05 . Вы можете добавить данный адрес в Вашу переменную PATH, используя следующую команду:

 *   export PATH=$PATH:/home/cs9242/crossdev/arm-2013.05/bin
 *   export PYTHONPATH=$PYTHONPATH:/home/cs9242/bin/py
  
Если Вы обладаете чересчур большой ленью, то Вы можете вместо запуска двоичных файлов запустить оболочку проекта 9242:

 *   ~ % 9242
 *   newclass starting new subshell for class COMP9242...
 *   ~ % arm-none-linux-gnueabi-ld
 *   arm-none-linux-gnueabi-ld: no input files
  
Обратите внимание: баудрейт в minicom должен быть установлен по умолчанию на 115200, порт типа 8N1, hardware flow control должен отсутствовать. Если настройки не выставлены подобным образом, у возникнут проблемы при работе с Вашим Sabre Lite.

Сборка Simple OS (SOS)
----------------------

    Скачайте себе копия скелета Simple OS. Мы используем git в качестве СКВ для данного проекта и это cамый лучший выбор. Вы будете присылать патчи/изменения для каждой контрольной работы в проекте. Мы поддерживаем и ожидаем только патчи, изменения, присланные через git. Вы должны будете поддерживать себя самостоятельно в случае использования Вами любых других инструментов.

	Вы можете найти некоторые подсказки по использованию git'а на нашей странице git
    
 *   git clone /home/cs9242/public_git/aos-2015
 *   cd aos-2015
 *   make aos_defconfig
 *   make

Получение SOS на машинах вне лаборатории
----------------------------------------

    Если Вы не используете машину в лаборатории, то Вам необходимо $PATH установлен в CSE:
    PATH=/home/cs9242/bin:$PATH
    После чего скачайте исходники AOS:
    git clone ssh://YOURLOGIN@login.cse.unsw.edu.au//home/cs9242/public_git/aos-2015 

Исходные коды проекта также доступны по адресу https://bitbucket.org/kevinelp/unsw-advanced-operating-systems для всех, кто заинтересован в обучении в проекте.

Запуск ОС на Sabre Light
------------------------

Загрузка Вашего Sabre Lite в первый раз будет проста до безумия:

    Вставьте в Ваш Sabre Lite USB и Ethernet и перезапустите его.
    В терминале запустите minicom, % minicom.
    Соберите, скопируйте образ образ Simple OS И перезапустите Ваш Sabre Lite, набрав % make.
    Вы должны увидеть успешную загрузку скелета Simple OS. Теперь Вы готовы к тому, чтобы создать новую ОС. Желаем удачи в данном процессе!

Цикл разработки
---------------

Мы создали некоторые инструменты для того, чтобы разработка шла быстрее. Makefile может скопировать Simple OS, представленную в виде загрузочного образа, в директорию Вашего tftp-сервера и перезапустить Sabre Lite. Ниже приведен алгоритм цикла разработки, включающий изменения пути до бинарных файлов в ваше скрипте входа:

    Вставьте в Sabre Lite все кабели, включая USB и Ethernet.
    В терминале запустите minicom: % minicom.
    В другом терминале запустите netcat: % nc -lup 26706.
    Меняйте, что хотите (на заметку: подучите cscope).
    Соберите, скопируйте образ Simple OS и перезапустите устройство: % make.
    Протестируйте Ваши изменения.
    Повторяйте пункты 4-6 до тех пор, пока не достигните своего или пока дремота не свалит Вас.
    Завершите minicom посредством комбинации Ctrl+A Q и завершите netcat комбинацией Ctrl+C. 

Цель данного занятия
--------------------

Представленный "скелет" ОС включает в себя приложение tty_test, которое запускается, печатает свое имя и затем блокирует себя до Второго Пришествия (но это не точно).

Данный пример включает в себя реализацию printf, которая выдает данные в консоль отлдки seL4. По факту - использует процедуру seL4 debug API под названием seL4_DebugPutChar. Эта функция может быть использована только для отладки SOS, поэтому Ваша задача - модифицировать процедуру sos_write для того чтобы отправить данные через ОС и через сеть в Вашу консоль netcat. 

Вторая часть вводной работы - это нахождение напарника для оставшейся части проекта. Проект будет завершаться в парах до тех пор пока Вы не получите допуска от Вашего научного руководителя.

Рекомендованная процедура
-------------------------

    Прочтите (и поймите) код в файле apps/sos/src/main.c и код в директории apps/tty_test приложения tty_test.
    Прочитайте документацию к библиотеке libserial.
    Разработайте простой IPC-протокол для передачи данных из программы пользователя в Вашу ОС (Список рекомендуемой литературы: seL4 Reference Manual, Глава 4 (вся), Глава 9 (Параграфы 9.1, 9.2, 9.3.9, 9.3.10, 9.3.11). Обратите внимание, что данные главы расставят все точки над i между программой tty_test и Simple OS.)
    Напишите клиентскую реализацию системного вызова sos_write.
    Отредактируйте syscall_loop в main.c для того чтобы опознать Ваш новый протокол и вывести отладочное сообщение, когда Вы получите одно из этих сообщений.
    Отредактируйте tty_test.c так, что она провела тест Вашей функции sos_write.
    Измените серверную часть так, чтобы данные выдавались в libserial, после чего отправлялись по сети.
    Протестируйте вывод программы tty_test и убедитесь, что вывод направлен не консоль отладки, а в консоль netcat'a.

Оценивание
----------

Подзадачи данной работы
-----------------------

Смотрите общие направления для подзадач данной работы для получения инструкций по отправке вашего решения.

Демонстрация результатов
------------------------

Вам нужно будет продемонстрировать приложение, выполняющееся в пространстве пользователя и печатающее сообщения во вторую консоль через libserial, с запущенным Sabre Lite во время демонстрации. Вы должны быть готовы показать Вашему тьютору какие именно файлы Вы поменяли и объяснить все Ваши решения, которые Вы реализовали.

Обратите внимание, что Вы не изучали управление последовательной виртуальной памятью, поэтому Ваш протокол не должен быть чересчур сложным. Как бы то ни было, Ваш протокол должен эволюционировать по мере того, как части Вашей ОС будут готовы. Ваш тьютор будет заинтересован, в частности, в деталях реализации межпроцессного взимодействия с блоками различного размера и по поводу того как Вы планируете улучшить это в будущем.

Поэтому небольшой совет: отправка байтов в единицу времени - это не самое лучшее решение.

Также Вы должны поставить Вашего тьютора в известность по поводу того, кто является Вашим партнером чтобы для Вас были созданы групповые аккаунты.
